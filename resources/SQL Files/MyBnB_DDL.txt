DROP TABLE IF EXISTS Users, Listings, Bookings, Reviews, Days, Amenities;

CREATE TABLE Users(
    username varchar(16) PRIMARY KEY NOT NULL,
    password varchar(16) NOT NULL,
    firstName varchar(15) NOT NULL,
    lastName varchar(15) NOT NULL,
    address varchar(25) NOT NULL,
    occupation varchar(20) NOT NULL,
    ssn varchar(9) NOT NULL,
    creditCard varchar(16),
    birthDate date NOT NULL
);

CREATE TABLE Listings(
    listingID int NOT NULL AUTO_INCREMENT,
    hostID varchar(16) NOT NULL,
    listingType varchar(20) NOT NULL,
    address varchar(25) NOT NULL,
    country varchar(16) NOT NULL,
    city varchar(24) NOT NULL,
    postalCode varchar(10) NOT NULL,
    price decimal(6, 2) NOT NULL,
    longitude decimal(9, 6) NOT NULL,
    latitude decimal(8, 6) NOT NULL,
    amenities varchar(255),
    PRIMARY KEY (listingID),
    FOREIGN KEY (hostID) REFERENCES Users(username)
);

CREATE TABLE Bookings(
    bookingID int NOT NULL AUTO_INCREMENT,
    listingID int NOT NULL,
    userID varchar(16) NOT NULL,
    status varchar(10) NOT NULL,
    startDate date NOT NULL,
    endDate date NOT NULL,
    PRIMARY KEY (bookingID),
    FOREIGN KEY (listingID) REFERENCES Listings(listingID),
    FOREIGN KEY (userID) REFERENCES Users(username)
);

CREATE TABLE Reviews(
    reviewerID varchar(16) NOT NULL,
    revieweeID varchar(16) NOT NULL,
    listingID int NOT NULL,
    reviewType varchar(7) NOT NULL,
    comment varchar(400),
    hostRating int,
    listingRating int,
    renterRating int,
    PRIMARY KEY (reviewerID, revieweeID),
    FOREIGN KEY (reviewerID) REFERENCES Users(username),
    FOREIGN KEY (revieweeID) REFERENCES Users(username),
    FOREIGN KEY (listingID) REFERENCES Listings(listingID)
);

CREATE TABLE Days(
	dayID INT AUTO_INCREMENT,
    listingID int NOT NULL,
    bookingiD int,
    status varchar(10) NOT NULL,
    startDate DATE NOT NULL,
    endDate DATE NOT NULL,
    PRIMARY KEY (dayID),
    UNIQUE KEY (listingID, startDate, endDate),
    FOREIGN KEY (listingID) REFERENCES Listings(listingID),
    FOREIGN KEY (bookingID) REFERENCES Bookings(bookingID)
);

CREATE TABLE Amenities(
    amenityID varchar(4) PRIMARY KEY NOT NULL,
    amenityName varchar(20) NOT NULL
);

INSERT into Users VALUES ('swaawilliam', '123', 'William', 'Slicer', '123 Street', 'Student', '123456789', 'creditCardnum', '1992-02-13');
INSERT into Listings VALUES (default, 'swaawilliam', 'House', '100 Addy', 'Canada', 'Toronto', 'M1P 2S2', 400.00, 23.000000, 42.000000, "1,");
INSERT into Amenities VALUES (1, 'Pool');
INSERT into Days VALUES (default, 4, NULL, 'available', 2022-12-13, 2022-12-26);
